!function(e){e.fn.Soautocomplete=function(t){return this.each(function(){this.timer=null,this.items=new Array,e.extend(this,t),e(this).attr("autocomplete","off"),e(this).on("focus",function(){e(this).parent().find("ul.dropdown-menu").show()}),e(this).on("blur",function(){setTimeout(function(i){i.hide()},200,this)}),e(this).on("keydown",function(i){switch(i.keyCode){case 27:this.hide();break;default:this.request()}}),this.click=function(i){i.preventDefault(),value=e(i.target).parent().attr("data-value"),value&&this.items[value]&&this.select(this.items[value])},this.show=function(){var i=e(this).position();e(this).siblings("ul.dropdown-menu").css({top:i.top+e(this).outerHeight(),left:i.left}),e(this).siblings("ul.dropdown-menu").show()},this.hide=function(){e(this).siblings("ul.dropdown-menu").hide()},this.request=function(){clearTimeout(this.timer),this.timer=setTimeout(function(i){i.source(e(i).val(),e.proxy(i.response,i))},200,this)},this.response=function(t,a){if(html="",t.length){for(i=0;i<t.length;i++)this.items[t[i].value]=t[i];for(i=0;i<t.length;i++)if(!t[i].category){html+='<li class="media" data-value="'+t[i].value+'" title="'+t[i].label+'">',t[i].image&&t[i].show_image&&1==t[i].show_image&&(html+='\t<a class="media-left" href="'+t[i].link+'"><img width="'+t[i].width+'px" height="'+t[i].height+'px" class="pull-left" src="'+t[i].image+'"></a>'),t[i].character=t[i].character.toLowerCase(t[i].character);var l=new RegExp("%20","g");t[i].character=t[i].character.replace(l," "),t[i].label=t[i].label.toLowerCase(t[i].label),t[i].label=t[i].label.replace(t[i].character,"<b>"+t[i].character+"</b>"),html+='<div class="media-body">',html+='<a href="'+t[i].link+'"><span>'+t[i].label+"</span></a>",t[i].price&&t[i].show_price&&1==t[i].show_price&&(html+='<div class="price">'+t[i].text_price+": "+t[i].price+"</div>"),html+="</div></li>",html+='<li class="clearfix"></li>'}var o=new Array;for(i=0;i<t.length;i++)t[i].category&&(o[t[i].category]||(o[t[i].category]=new Array,o[t[i].category].name=t[i].category,o[t[i].category].item=new Array),o[t[i].category].item.push(t[i]));for(i in o)for(html+='<li class="dropdown-header">'+o[i].name+"</li>",j=0;j<o[i].item.length;j++)html+='<li data-value="'+o[i].item[j].value+'"><a href="#">&nbsp;&nbsp;&nbsp;'+o[i].item[j].label+"</a></li>"}html?this.show():this.hide(),e(this).siblings("ul.dropdown-menu").html(html),e(".icon-loading",a).removeClass("loading")},e(this).after('<ul class="dropdown-menu"></ul>')})}}(window.jQuery),function(i){jQuery(document).ready(function(i){i(".swsearch-wrapper .search").each(function(){var e=i(this);if(e.data("ajax_search")){var t,a=0,l=e.data("show_image"),o=e.data("show_price"),n=e.data("character"),r=e.data("height_image"),s=e.data("width_image"),h=e.data("limit"),c=e.data("no_result"),d=e.data("text_price");i(e).find(".autosearch-input").Soautocomplete({delay:500,source:function(u,m){var p=i('select[name="category"]',e).first().val(),g=e.data("admin_url").replace("%%endpoint%%","sw_search_products_callback");void 0===p&&(p=0),t&&4!=t.readystate&&(i(".icon-loading",e).removeClass("loading"),t.abort()),u.length>=n?(i(".icon-loading",e).addClass("loading"),t=i.ajax({url:g,dataType:"json",data:{action:"sw_search_products_callback",filter_category_id:p,limit:h,width:s,height:r,filter_name:encodeURIComponent(u)},success:function(t){t.length>0?m(i.map(t,function(i,e){return a=0,i.total&&(a=i.total),{character:encodeURIComponent(u),price:i.price,label:i.name,image:i.image,link:i.link,show_price:o,show_image:l,width:s,height:r,value:i.product_id,text_price:d}})):(html='<li class="no-result">'+c+"</li>",i("ul.dropdown-menu",e).html(html),i("ul.dropdown-menu",e).show(),i(".icon-loading",e).removeClass("loading"))}})):i("ul.dropdown-menu",e).hide()}})}})})}(jQuery);